import { readFileSync, writeFileSync } from 'fs';

// These are types autogenerated by the graphql-codegen that we need to prefix
// so they don't collide with the types from the different services
const helperTypes = [
  'Maybe',
  'InputMaybe',
  'Exact',
  'Incremental',
  'MakeOptional',
  'MakeMaybe',
  'MakeEmpty',
  'Scalars',
];

const [, , filePath] = process.argv;
if (!filePath) {
  console.log('File type is missing');
  process.exit(1);
}

const fileContent = readFileSync(filePath, 'utf-8');
let modifiedContent = fileContent;

// Avoid exporting the helper types so they don't collide among the different services types
helperTypes.forEach((type) => {
  modifiedContent = modifiedContent.replaceAll(
    `export type ${type}`,
    `type ${type}`
  );
});

// Avoid using "any" type in the helper types
modifiedContent = modifiedContent.replaceAll(': any', ': unknown');

writeFileSync(filePath, modifiedContent);
